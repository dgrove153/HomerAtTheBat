extends layout

block inlineScripts

block content
	include partials/team
	include partials/draftPicks
	include partials/cash

	mixin vulture(array, header, isInbound)
		-if(array.length > 0)
			p= header
			table
				thead
					th Player
					-if(isInbound)
						th Vulturing Team
					-else
						th Player's Team
					th Deadline
				tbody
					-each v in array
						tr
							td= v.name_display_first_last
							td
								-if(isInbound)
									a(href="/team/" + v.vulture.vulture_team)= v.vulture.vulture_team
								-else
									a(href="/team/" + v.history[0].fantasy_team)= v.history[0].fantasy_team
							td= moment(v.vulture.deadline).format('h:mm a [EST], M/D')
							-if(isInbound && user && user.team == team.team)
								td
									a(href="/gm/vulture/fix/" + v.player_id) Click to Fix

	section(id="top")
		div
			h1= team.fullName
			p= vulture_message

	section(id="left")
		div
			h2 Roster
			p(style="display:inline;padding-right:10px") Previous rosters:
			a(href="/team/" + team.team + "/2013") 2013
			br
			
			-if(user != null)
				-if(user.team == team.team)
					a(href="/gm/keepers/" + team.team style="margin-right:20px") Select Keepers
				-if(user.role == 'admin' || (isTradingOn && user != null && user.team != team.team))
					a(href="/gm/trade/propose/" + team.team) Trade

			-if(!isKeeperPeriod || (user != null && user.team == team.team))
				mixin team(players, true)
			-else
				p Check back after the keeper deadline for 2014 roster

			-if(isTradingOn)
				h2 Trades
				-each trade in inTrades
					a(href="/gm/trade/" + trade._id)= "From " + trade.from.team
					-each player in trade.from.players
						a= player

					-each player in trade.to.players
						a= player
					br
				-each trade in outTrades
					a(href="/gm/trade/" + trade._id)= "Proposed to " + trade.to.team
					-for(var i = 0; i < trade.to.players.length; i++) {
						a(href="/admin/player/" + trade.to.players[i])= trade.to.player_names[i]
					- }

					-for(var i = 0; i < trade.from.players.length; i++) {
						a(href="/admin/player/" + trade.from.players[i])= trade.from.player_names[i]
					- }
					br

	section(id="right")
		div
			-if((in_vultures && in_vultures.length > 0) || (out_vultures && out_vultures.length > 0))
				h2 Vultures
				mixin vulture(in_vultures, "Vultures on " + team.team + "'s Players", true)
				mixin vulture(out_vultures, "Vultures made by " + team.team, false)

		div
			h2 Finances
			mixin cash(team, cash)

		div
			h2 Minor League Draft Picks
			mixin draftPicks(team, picks, teamHash)